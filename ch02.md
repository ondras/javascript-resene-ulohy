# Kapitola 2: První setkání

## Zadání

Pro fanoušky Karla Gotta chystáme vzpomínkový web, který bude obsahovat i texty písní. Některé jsou ale příliš dlouhé, takže je nutné zobrazit jen prvních několik znaků a zbytek textu skrýt. Po kliknutí na tlačítko se ukáže celý text písně.

## Řešení

```html
<h1>Mám styl Čendy</h1>
<pre>
Mezi námi je mnoho chvil
A pokusů, abych se ti zavděčil
Jenomže od tebe se člověk moc nedoví
Stále básníš o ňákém svém záhadném Čendovi
</pre>

<script>
let song = document.querySelector("pre");
let text = song.textContent;

song.textContent = text.substring(0, 50) + "...";

let button = document.createElement("button");
button.textContent = "zobrazit celý text";
song.append(button);

function showCompleteText() {
	song.textContent = text;
}
button.addEventListener("click", showCompleteText);
</script>
```

První setkání s JavaScriptem! Výše uvedený kód představuje řešení naší úlohy, které z textu písně zobrazí prvních 50 znaků a zbytek skryje. Po kliknutí na tlačítko se odhalí text celý.

Úvodem přiznejme, že se rozhodně nejedná o nejlepší řešení. Zkušený programátor v něm jistě nalezne místa k vylepšení. Některá z nich si ukážeme v první začátečnické podkapitole. Předtím se ale podíváme na celé vzorové řešení řádek po řádku a vysvětlíme, co vše se z něj můžeme naučit.

Převážná většina této knihy se týká *klientského JavaScriptu*, tedy tomu scénáři, kdy jazyk používáme pro vylepšení webových stránek. Technologicky to znamená, že:
  - k vyzkoušení potřebujeme libovolný webový prohlížeč (tzv. *klient*)
  - v prohlížeči otevíráme webovou (HTML) stránku, jejíž přímou či nepřímou součástí je JavaScriptový kód
  - prohlížeč proto v rámci zobrazení stránky musí také stáhnout a vykonat instrukce, obsažené v tomto kódu

Tím pádem není nutné používat žádný specializovaný software, který by JavaScript zpracovával (interpretoval, kompiloval, …). Naopak je potřeba alespoň trochu rozumět HTML, protože výsledná stránka je s JavaScriptem niterně provázána: kód píšeme proto, aby stránku vylepšoval, ovlivňoval a měnil.

Prvních několik řádků řešení je tím pádem prosté HTML (s ukázkou jednoho textu písně, za který děkujeme textaři panu Michalu Bukovičovi). Prohlížeč je zpracuje a zobrazí &ndash; kdyby ve zbylé části stránky nebyl žádný JavaScript, uživatel by viděl celý text. Přítomnost značky `<script>` ovšem prohlížeči káže, že než bude stránka hotová, je nezbytné vykonat uvedený kód.

Tím se dostáváme ke skriptu samotnému. Jeho první dva řádky začínají klíčovým slovem `let`, kterým uvozujeme definici proměnných. Vytváříme dvě proměnné (`song` a `text`) a rovnou je naplníme hodnotami pomocí znaku rovnítka (tzv. *operátor přiřazení*). Protože naším cílem je manipulace se stránkou (skrytí části textu), potřebujeme se především dostat k jednotlivýcm HTML prvkům ve stránce a jejich obsahu. To je ve světě klientského JavaScriptu možné pomocí sady funkcí a objektů, souhrnně nazývaných DOM &ndash; Document Object Model. Jedná se o velice silný nástroj, který budeme využívat v téměř všech kapitolách. Pomocí DOM můžeme do stránky vkládat nový obsah, upravovat existující, nebo klidně stránku celou vymazat a sestavit znova a jinak.

Rozhraní DOM je pro nás přístupné především pomocí globální vestavěné proměnné `document`. Ta odpovídá té stránce, kterou prohlížeč právě zobrazuje (a jejíž JavaScript je právě vykonáván). V dokumentaci lze nalézt veliké množství vlastností a funkcí, které takový `document` nabízí &ndash; na některé z nich se podíváme v nadcházející podkapitole pro FIXME. I zelenáč ovšem musí ovládat funkci `querySelector`, kterou používáme k tomu, abychom v dokumentu vyhledali konkrétní HTML prvek. Parametrem pro `querySelector` je řetězec obsahující *CSS selektor*, který známe ze světa CSS. Tam jej používáme pro stejný účel, když vybíráme HTML značky, na které se mají aplikovat daná stylová pravidla.

V první proměnné (`song`) tak skončí první značka `<pre>` ve stránce &ndash; náš text písně. Druhou proměnnou (`text`) pak naplníme samotným obsahem dané HTML značky; její datový typ bude řetězec. Používáme k tomu vlastnost `textContent`, která opět pochází ze světa DOM.

Následující řádek slouží ke skrytí většiny textu:
```js
song.textContent = text.substring(0, 50) + "...";
```

To je naše první opravdová *manipulace* s DOMem, tedy se stránkou! Přiřazením do vlastnosti `textContent` rozkazujeme, že je nutné HTML pozměnit nahrazením textu, který se zobrazuje uvnitř značky `<pre>` (tj. uvnitř proměnné `song`). Vypíšeme v ní prvních padesát znaků z textu (funkce `substring` vrátí podřetězec od/do zadané pozice) a k tomu ještě připojíme tři tečky &ndash; naznačení, že v těchto místech je cosi skryto. Můžeme si rovnou povšimnout použitého znaménka `+`, které v JavaScriptu funguje nejen pro aritmetiku (sčítání), ale také pro spojování řetězců. V dalších kapitolách ovšem uvidíme, že tato forma kombinace řetězců není jediná a často je vhodnější použít jiný zápis.


## Zelenáči: drobná vylepšení

## Někdo: začínáme s DOMem

## Profíci: druhy skriptů


